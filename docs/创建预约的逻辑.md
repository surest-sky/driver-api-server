创建预约时就扣 credits
     api-server/src/modules/appointments/appointments.service.ts:140 到 api-server/src/modules/
     appointments/appointments.service.ts:174
     这里在 create() 里直接做了 -requiredCredits 并写入 credit_records。
  2. 取消预约会退还 credits
     api-server/src/modules/appointments/appointments.service.ts:359 到 api-server/src/modules/
     appointments/appointments.service.ts:366
     取消后调用 _refundCredits()；退款实现见 api-server/src/modules/appointments/
     appointments.service.ts:693。
  3. 拒绝预约也会退还 credits
     api-server/src/modules/appointments/appointments.service.ts:292 到 api-server/src/modules/
     appointments/appointments.service.ts:299。
  4. 完成课程不会再扣一次
     complete() 只改状态为 completed，没有 credit 扣减逻辑：api-server/src/modules/appointments/
     appointments.service.ts:393。

  补充：学员取消有“开课前 2 小时内不可取消”的限制（api-server/src/modules/appointments/
  appointments.service.ts:340）